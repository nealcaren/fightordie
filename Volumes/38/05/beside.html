<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W.E.B. Du Bois">
<meta name="dcterms.date" content="1931-05-01">

<title>Beside the Still Water – Dare You Fight</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta name="citation_title" content="Beside the Still Water">
<meta name="citation_author" content="W.E.B. Du Bois">
<meta name="citation_publication_date" content="1931-05-01">
<meta name="citation_cover_date" content="1931-05-01">
<meta name="citation_year" content="1931">
<meta name="citation_online_date" content="1931-05-01">
<meta name="citation_fulltext_html_url" content="https://www.dareyoufight.org/Volumes/38/05/beside.html">
<meta name="citation_issue" content="5">
<meta name="citation_volume" content="38">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="168">
<meta name="citation_lastpage" content="169">
<meta name="citation_journal_title" content="The Crisis">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../Images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Dare You Fight</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../listing.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../covers.html"> 
<span class="menu-text">Covers</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Beside the Still Water</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>W.E.B. Du Bois </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 1, 1931</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><em>This is the speech made by the Editor of </em>The Crisis* when the Lieutenant Governor of the State of New York bestowed the 17th Spingarn Medal on Richard B. Harrison.*</p>
<p><em>The investiture took place in Mansfield Theatre, New York, where “The Green Pastures” is beginning its second year’s run. There were present, the author and producer of the play, four Spingarn Medalists, the founder of the Medal and an audience of one thousand.</em></p>
<p><em>Most of the audience applauded the speech, but there was a grim and critical group who quite evidently did not like it. What do you say?</em></p>
<p>This is peculiarly the occasion to say a word of the relationship between the theatre and the American Negro. The stage still retains among us something of freedom and the forward gaze. Behind the footlights one is permitted to examine and discuss Truth under circumstances where literature is stifled, painting inarticulate, sculpture choked of convention, architecture drowned in weaves of monstrosity and music fettered by death.</p>
<p>But this continuing freedom of dramatic art is due to no courage of managers nor merit of dramatists, and is threatened not only by the well recognized fat degeneration of musical comedy, but by that secret, internal and devastating malady which attacks an art which is free to treat in truth, and yet afraid to look it fair in the face. This is the present attitude of the American theatre as it faces the Negro.</p>
<hr>
<p>The stranger from the stars bursting in upon earth today would, without shadow of a doubt or moment of hesitancy, fasten upon the plight of the black man in America as the most dramatic stuff of the modern world. Convict this harsh and heavy thrust of the dark and primitive peoples, out of the soft green and gold and clan tradition of the tropics, into the anarchy of the Reformation and French Revolution and the punishment of Victoria’s African territories fed on flesh across the whole Atlantic. The isles of the Caribbean shrieked to Boston and New Orleans; the Mississippi swept the white labor on black slavery and fought valley of black lowlands and Appalachians.</p>
<p>Nothing escaped it—neither religion nor philosophy, literature nor art, science nor government. Across a continent, across a world, the horror and tragedy and farce of this stupendous drama flew, and beside it men and women danced, and above it rolled a nerve-to-forgotten song. The souls of stricken millions descended into Hell and the third century arose again from the dead—with what blood and pricking pain—with such exquisite horror of hurt, as humanity has seldom known.</p>
<p>Every known element of human drama, every device of theatrical effect was here—the crucifixion of motherhood, the murder of children, the rape of homes; piteous debasement and nameless exaltation of the spirit of man. There was lacking no impudence of wealth nor depths of uttermost pits of poverty. There was the ding of whips, the fangs of dogs, the laughter of power, the refinement of cruelty and the sobbing abasement of the lowliest of the low—dragged slowly and bitterly and relentlessly out over endless years. This is the thing that today America makes merry over. It is our major amusement. It is material for clowns and braying jokes. It is our national perennial issue.</p>
<p>Yet for four hundred years of the fury fire and blood of this land’s history, wars black and crimson thread of a madcap hand wove end every pattern, and not the double tongues of all the Donnius and Charles Beard shall alter the red record of one jot of it.</p>
<hr>
<p>Before this mightiest of human dramas, save here and there a lucid interval, the American theatre has sat distraught, dumb and stupid, with a vacant grin on its face: afraid of the truth, cowed by the tragedy, aghast at the very intricacy and endless implications of the plots. American playwrights have strained their inwards to submerge this drama into farce; to turn the piteous tragedy of the Negro into cheap pornographic bathos; to paint this all too human life into a degenerate reflection of their own sadistic desires. Until today on stage and in literature, in painting, in all art, save alone in music, the souls of black folk have been submerged in fetid filth and white pimps who finance and exploit black prostitutes in “Nigger Heaven” have quite concealed the blazing Hell beneath; and persuaded a complacent world that Harlem has no light of common day; that underneath our sale of laughter lie no pools of bitter tears.</p>
<p>Not only has the American theatre refused to face the drama of the Negro problem, but it has opposed every effort of the Negro himself to find dramatic expression on the stage. It is not enough, in this great and free commonwealth of the spirit of man, that most training schools of drama and art are closed to black folk; it is not enough that in the annual nationwide radio audition no voice of an angel in a black skin may be heard; it is not enough that the American schools at Fontainbleau, supported by the leaders in American painting, sculpture and architecture, have sought to extend the American color line across France—all this perhaps must be tolerated and even awaited in arts dominated by money, by the private profit ideal and by cheap and smug convention. But in the freer air of the drama, despite its all too evident pandering to monopoly and the intellectual mob, it is astonishing to realize the fight which the black actor has had to gain the merest shadow of foothold on Broadway. No one is child enough to believe that a black skin makes an actor, or that the suffering of a people creates of itself the delicate art to portray it. But when the artist does appear, proven and clear, it is almost unbelievable that his fellow white artists would so long and so persistently deny him full recognition.</p>
<hr>
<p>When Europe of the early 19th Century recognized the great Jewess, Rachel, and the great Negro, Aldridge, as the two outstanding leaders of the stage, whom governments and science and art delighted to honor, that black man could not put foot on a single legitimate stage in the land of his birth. But even after slavery, and from 1870 down nearly to our day, the Negro actor could appear at Court only as the king’s fool, with cap and bells, with quip and joke, ready over his own heartbreak to guffaw lustily and dance fantastically for the massed amusement of morons. Even when the unchangeable logic of a particular plot demanded black characters, up until yesterday, even these parts must be taken by white folk with blackened faces, unknown dialect and an unusually dumb mental equipment. This nonsense in time went beyond the limit of New York complacency and today not even burnt cork could save a miserable play, although supported by the bad acting of the royal family.</p>
<p>This hesitancy of our freest form of art really to be free; this refusal of managers, playwrights and players to use normally and intelligently, the abundant stuff of dramatic material and the not infrequent genius in acting which a nation within a nation furnishes—a black nation greater than Ireland, Belgium, Austria or Portugal—a nation equal in numbers to Egypt, Persia, Czechoslovakia and all Scandinavia—this studied neglect of the most dramatic material in America, has already reacted and will react on the theatre in the United States. A freedom unused is perverted or lost. If the stage dare not frankly and fully portray the Negro problem because of fear and snobbery—because of a provincial mentality born of the slave oligarchy, spawned south of the Mason and Dixon line and transplanted to the congenial concrete sidewalks of New York—the American theatre will find itself with all the greater ease and easier logic denied the right to discuss sex and war, socialism and Russia, liquor and wealth, and anything which at any time an entrenched autocracy or a prurient puritanism or a Nordic impudence may guard with the shackles of censorship.</p>
<hr>
<p>The abiding refuge of our optimism is the slow growth of normal dramatic instinct among us even anent the Negro; the slow expansion of a national receptive audience unafraid of racial problems. True it is that the fear still lurks; for the stage is still slow and the effective audience too small—and already something may have been eternally lost in creative genius, dramatic ability and the unhampered critical spirit; but “<em>The Green Pastures</em>” has helped our hope, and it has helped not so much in form and word and authorship as in the deft and subtle marvel of its interpretation. For skillful as the written play may be, the secret of its triumph lies in its interpretation by Negro actors, and above all in the high and delicate genius of Richard Berry Harrison.</p>
<p>Even here an abundant satisfaction is haunted by a bleak memory. I have known Richard Harrison for thirty-five years. He stands before you tonight with smiling lips and the tranquil courage of a high heart. But I know—I know what crucifixion this man has suffered. Here is a white man of singular capacity and noble beauty who had a black great-grandfather. And who because of that fact and that alone—because of a truth he saw no reason to deny or conceal,—he has been given in this land of the free and home of the brave, from 1864-1930, sixty-six years, no real opportunity, no fair chance, no liberty for the genius that always lay in him, until 1930 and even then almost by accident.</p>
<p>What the author of this play expected in its presentation, I do not know; but you and I know full well and of a certainty what the first audiences expected—what any average American audience expects when Negro actors appear in a Negro play. They expected amusement; they expected slap-stick and broad farce; they expected filth. They licked dry lips, for “The Green Pastures” of their imagination would be gaudy with food and fun, and of the Still Waters beneath they recked nothing.</p>
<p>If Richard Harrison had learned to dance clog and make faces in his youth, he might have riches now. But his demand for sincere drama, for the sting of tragedy and the high humor of true comedy, had led him long years face to face with hunger and poverty, straight on toward careless neglect. He was not one to complain. He has the high and African gift of laughter. He too has looked at death and smiled.</p>
<hr>
<p>Atlast the closed gate opened, so casually, so carelessly, that Harrison himself was not sure of what he saw—not sure it was The Gate. Someone was needed to portray God as a “nigger” minstrel on Broadway. But it had to be delicately done. There were churches and censors to avoid, there were susceptibilities to be soothed and creeds to be mollified. The audience must surely be tickled and amused, but its mirth must be in bounds, subdued to something like decorum at least in spots.</p>
<p>This called for subtlety in interpretation and understanding—for a deep and human knowledge of mankind, especially of that manner of men who live behind the veil of color, yet are men. Human beings, whether dark and singing slaves or white and bored seekers of Broadway pleasure, must on this stage, see God and live. Who could do this miracle of acting?</p>
<p>When manager and playwright turned to find such a man they faced a wall. They knew few Negro actors. To Broadway the Negro was not an actor, he was a vaudeville turn. True it was that Charles Gilpin, by the tragedy of his own damnation had, with dying flair of genius and clairvoyance of O’Neill, forced the Negro defeatist psychology partially across the footlights. Half willingly thereafter, Broadway endured patronizingly Robeson and Rose McClendon for limited periods and with the clearly expressed proviso, that the author engage in the climax to kill the black hero, or destroy him or rend his soul from his body. Then the white audience could depart secure in the knowledge that all Negro aspiration and effort, by the very constitution of the universe, must ever end in annihilation and defeat, frustration and death.</p>
<p>But this climax would not suit “The Green Pastures.” Even on the American stage, God must be reasonably successful; and Richard Harrison almost as a last resort was offered the opportunity to try this role.</p>
<hr>
<p>What he accomplished, the nation knows. By the breadth of a hair and half-turn of a phrase—by a gesture and a silence, he guided a genial comedy into a great and human drama. Small wonder that only those who see the miracle, can gauge the genius of its doing or realize the rare perfection of its detailed accomplishment. The south, the west, which have not seen the actor and the play are curious and skeptical concerning it. With puzzled frown they inquire into its impression and results and shake vague heads. One can clearly understand how England, reading the text alone, can not escape the feeling that its content must either be blasphemy or farce. And yet no human soul witnessing a performance can doubt the lure of its human kindliness and the mighty tragedy beneath the deep and reverent guidance of a great actor.</p>
<p>What you then as audience and two as authors have unleashed and unbound in this great soul—what you have freed and unfettered in a man and a race, is but earnest of what actors you may see and what drama you may evoke, if instead of hiding your heads in the sand and scurrying abroad to borrow for the American stage the second-hand situations of Paris and Vienna, you open purblind eyes and glance about you.</p>
<p>This meeting tonight is a tribute to Richard Harrison—a tribute belated and artificial, but none the less sincere. He is in his charm and courtesy, his tact and tolerant philosophy, one to be emulated and envied. Toward this distracting problem of race, he is far finer than many of his darker friends, for he walks without plaint or protest even in his hurt; while I, by God, front earth and high Heaven with insistent and unceasing clamor against this throttling of the Art of beauty, against this enchaining of the human spirit—against, to be sure, its cruelty and pain,—but even more, against its crass stupidity.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-du_bois1931" class="csl-entry quarto-appendix-citeas" role="listitem">
Du Bois, W.E.B. 1931. <span>“Beside the Still Water.”</span> <em>The
Crisis</em> 38 (5): 168–69. <a href="https://www.dareyoufight.org/Volumes/38/05/beside.html">https://www.dareyoufight.org/Volumes/38/05/beside.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dareyoufight\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>