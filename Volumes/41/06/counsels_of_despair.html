<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W.E.B. Du Bois">
<meta name="dcterms.date" content="1934-06-01">

<title>Counsels of Despair – Dare You Fight</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta name="citation_title" content="Counsels of Despair">
<meta name="citation_author" content="W.E.B. Du Bois">
<meta name="citation_publication_date" content="1934-06-01">
<meta name="citation_cover_date" content="1934-06-01">
<meta name="citation_year" content="1934">
<meta name="citation_online_date" content="1934-06-01">
<meta name="citation_fulltext_html_url" content="https://www.dareyoufight.org/Volumes/41/06/counsels_of_despair.html">
<meta name="citation_issue" content="6">
<meta name="citation_volume" content="41">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="182">
<meta name="citation_lastpage" content="184">
<meta name="citation_journal_title" content="The Crisis">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../Images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Dare You Fight</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../listing.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../covers.html"> 
<span class="menu-text">Covers</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Counsels of Despair</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>W.E.B. Du Bois </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 1, 1934</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Many persons have interpreted my reassertion of our current attitude toward segregation as a counsel of despair. We can’t win, therefore, give up and accept the inevitable. Never, and nonsense. Our business in this world is to fight and fight again, and never to yield. But after all, one must fight with his brains, if he has any. He gathers strength to fight. He gathers knowledge, and he raises children who are proud to fight and who know what they are fighting about. And above all, they learn that what they are fighting for is the opportunity and the chance to know and associate with black folk. They are not fighting to escape themselves. They are fighting to say to the world: the opportunity of knowing Negroes is worth so much to us and is so appreciated, that we want you to know them too.</p>
<p>Negroes are not extraordinary human beings. They are just like other human beings, with all their foibles and ignorance and mistakes. But they are human beings, and human nature is always worth knowing, and withal, splendid in its manifestations. Therefore, we are fighting to keep open the avenues of human contact; but in the meantime, we are taking every advantage of what opportunities of contact are already open to us, and among those opportunities which are open, and which are splendid and inspiring, is the opportunity of Negroes to work together in the twentieth century for the uplift and development of the Negro race. It is no counsel of despair to emphasize and hail the opportunity for such work.</p>
<section id="the-anti-segregation-campaign" class="level2">
<h2 class="anchored" data-anchor-id="the-anti-segregation-campaign">The Anti-Segregation Campaign</h2>
<p>The assumptions of the anti-segregation campaign have been all wrong. This is not our fault, but it is our misfortune. When I went to Atlanta University to teach in 1897, and to study the Negro problem, I said, confidently, that the basic problem is our racial ignorance and lack of culture. That once Negroes know civilization, and whites know Negroes, then the problem is solved. This proposition is still true, but the solution is much further away that my youth dreamed. Negroes are still ignorant, but the disconcerting thing is that white people on the whole are just as much opposed to Negroes of education and culture, as to any other kind, and perhaps more so. Not all whites, to be sure, but the overwhelming majority.</p>
<p>Our main method, then, falls flat. We stop training ability. We lose our manners. We swallow our pride, and beg for things. We agitate and get angry. And with all that, we face the blank fact: Negroes are not wanted; neither as scholars nor as business men; neither as clerks nor as artisans; neither as artists nor as writers. What can we do about it? We cannot use force. We cannot enforce law, even if we get it on the statute books. So long as overwhelming public opinion sanctions and justifies and defends color segregation, we are helpless, and without remedy. We are segregated. We are cast back upon ourselves, to an Island Within; “To your tents, Oh Israel!”</p>
<p>Surely then, in this period of frustration and disappointment, we must turn from negation to affirmation, from the ever-lasting “No” to the ever-lasting “Yes.” Instead of sitting, sapped of all initiative and independence; instead of drowning our originality in imitation of mediocre white folks; instead of being afraid of ourselves and cultivating the art of skulking to escape the Color Line; we have got to renounce a program that always involves humiliating self-stultifying scrambling to crawl somewhere where we are not wanted; where we crouch panting like a whipped dog. We have got to stop this and learn that on such a program they cannot build manhood. No, by God, stand erect in a mud-puddle and tell the white world to go to hell, rather than lick boots in a parlor.</p>
<p>Affirm, as you have a right to affirm, that the Negro race is one of the great human races, inferior to none in its accomplishment and in its ability. Different, it is true, and for most of the difference, let us reverently thank God. And this race, with its vantage grounds in modern days, can go forward of its own will, of its own power, and its own initiative. It is led by twelve million American Negroes of average modern intelligence; three or four million educated African Negroes are their full equals, and several million Negroes in the West Indies and South America. This body of at least twenty-five million modern men are not called upon to commit suicide because somebody doesn’t like their complexion or their hair. It is their opportunity and their day to stand up and make themselves heard and felt in the modern world.</p>
<p>Indeed, there is nothing else we can do. If you have passed your resolution, “No segregation, Never and Nowhere,” what are you going to do about it? Let me tell you what you are going to do. You are going back to continue to make your living in a Jim-Crow school; you are going to dwell in a segregated section of the city; you are going to pastor a Jim-Crow Church; you are going to occupy political office because of Jim-Crow political organizations that stand back of you and force you into office. All these things and a thousand others you are going to do because you have got to.</p>
<p>If you are going to do this, why not say so? What are you afraid of? Do you believe in the Negro race or do you not? If you do not, naturally, you are justified in keeping still. But if you do believe in the extraordinary accomplishment of the Negro church and the Negro college, the Negro school and the Negro newspaper, then say so and say so plainly, not only for the sake of those who have given their lives to make these things worthwhile, but for those young people whom you are teaching, by that negative attitude, that there is nothing that they can do, nobody that they can emulate, and no field worthwhile working in. Think of what Negro art and literature has yet to accomplish if it can only be free and untrammeled by the necessity of pleasing white folks! Think of the splendid moral appeal that you can make to a million children tomorrow, if once you can get them to see the possibilities of the American Negro today and now, whether he is segregated or not, or in spite of all possible segregation.</p>
</section>
<section id="protest" class="level2">
<h2 class="anchored" data-anchor-id="protest">Protest</h2>
<p>Some people seem to think that the fight against segregation consists merely of one damned protest after another. That the technique is to protest and wail and protest again, and to keep this thing up until the gates of public opinion and the walls of segregation fall down.</p>
<p>The difficulty with this program is that it is physically and psychologically impossible. It would be stopped by cold and hunger and strained voices, and it is an undignified and impossible attitude and method to maintain indefinitely. Let us, therefore, remember that this program must be modified by adding to it a positive side. Make the protest, and keep on making it, systematically and thoughtfully. Perhaps now and then even hysterically and theatrically; but at the same time, go to work to prepare methods and institutions which will supply those things and those opportunities which we lack because of segregation. Stage boycotts which will put Negro clerks in the stores which exploit Negro neighborhoods. Build a 15th Street Presbyterian Church, when the First Presbyterian would rather love Jesus without your presence. Establish and elaborate a Washington system of public schools, comparable to any set of public schools in the nation; and then when you have done this, and as you are doing it, and while in the process you are saving your voice and your temper, say softly to the world: see what a precious fool you are. Here are stores as efficiently clerked as any where you trade. Here is a church better than most of yours. Here are a set of schools where you should be proud to send your children.</p>
</section>
<section id="the-conservation-of-races" class="level2">
<h2 class="anchored" data-anchor-id="the-conservation-of-races">The Conservation of Races</h2>
<p>The Second Occasional Papers published by The American Negro Academy was “The Conservation of Races” by W. E. B. Du Bois, and was published in 1897. On page 11, I read with interest this bit:</p>
<blockquote class="blockquote">
Here, then, is the dilemma, and it is a puzzling one, I admit. No Negro who has given earnest thought to the situation of his people in America has failed, at some time in life, to find himself at these cross-roads; has failed to ask himself at some time: What, after all, am I? Am I an American or am I a Negro? Can I be both? Or is it my duty to cease to be a Negro as soon as possible and be an American? If I strive as a Negro, am I not perpetuating the very cleft that threatens and separates Black and White America? Is not my only possible practical aim the subduction of all that is Negro in me to the American? Does my black blood place upon me any more obligation to assert my nationality than German, or Irish or Italian blood would?
<p>
It is such incessant self-questioning and the hesitation that arises from it, that is making the present period a time of vacillation and contradiction for the American Negro; combined race action is stifled, race responsibility is shirked, race enterprises languish, and the best blood, the best talent, the best energy of the Negro people cannot be marshalled to do the bidding of the race. They stand back to make room for every rascal and demagogue who chooses to cloak his selfish deviltry under the veil of race pride.
</p><p>
</p><p>Is this right? Is it rational? Is it good policy? Have we in America a distinct mission as a race—a distinct sphere of action and an opportunity for race development, or is self-obliteration the highest end to which Negro blood dare aspire?</p>
</blockquote>
<p>On the whole, I am rather pleased to find myself still so much in sympathy with myself.</p>
</section>
<section id="methods-of-attack" class="level2">
<h2 class="anchored" data-anchor-id="methods-of-attack">Methods of Attack</h2>
<p>When an army moves to attack, there are two methods which it may pursue. The older method, included brilliant forays with bugles and loud fanfare of trumpets, with waving swords, and shining uniforms. In Coryn’s “The Black Eagle,” which tells the story of Bertrand du Guesclin, one sees that kind of fighting power in the fourteenth century. It was thrilling, but messy, and on the whole rather ineffective.</p>
<p>The modern method of fighting, is not nearly as spectacular. It is preceded by careful, very careful planning. Soldiers are clad in drab and rather dirty khaki. Officers are not riding out in front and using their swords; they sit in the rear and use their brains. The whole army digs in and stays hidden. The advance is a slow, calculated forward mass movement. Now going forward, now advancing in the center, now running around by the flank. Often retreating to positions that can be better defended. And the whole thing depending upon G.H.Q.; that is, the thought and knowledge and calculations of the great general staff. This is not nearly as spectacular as the older method of fighting, but it is much more effective, and against the enemy of present days, it is the only effective way. It is common sense based on modern technique.</p>
<p>And this is the kind of method which we trust use to solve the Negro problem and to win our fight against segregation. There are times when a brilliant display of eloquence and picketing and other theatrical and spectacular things are not only excusable but actually gain ground. But in practically all cases, this is true simply because of the careful thought and planning that has gone before. And it is a waste of time and effort to think that the spectacular demonstration is the real battle.</p>
<p>The real battle is a matter of study and thought; of the building up of loyalties; of the long training of men; of the growth of institutions; of the inculcation of racial and national ideals. It is not a publicity stunt. It is a life.</p>
</section>
<section id="the-new-negro-alliance" class="level2">
<h2 class="anchored" data-anchor-id="the-new-negro-alliance">The New Negro Alliance</h2>
<p>We find ourselves in sudden and apparently complete agreement with our young friends of Washington. It seems that the alliance fell afoul of ordinances against picketing, but that this did not result altogether in failure. Two pickets were arrested, and finally, after a month or so, the complaints were dismissed. In another case, a complaint and temporary injunction is still being fought out before the courts. This is fine. We are glad that the picketing has met with so much of success and we hope that in Washington, as in Chicago, ultimate success will come.</p>
<p>Further than this, the alliance explains that what it is doing, is asking for clerks whose color in the main shall correspond to neighborhoods. If there is a store in a black neighborhood, there should be at least some black clerks in the store. With this, we quite agree, and say, as we said in the Chicago case, that this is fighting segregation with segregation. If there are, for instance (and there certainly are in Washington), segregated neighborhoods, don’t squat before segregation and bawl. Use segregation. Use every bit that comes your way and transmute it into power. Power that some day will smash all race separation. In the meantime, call it what you will. If the Negro Alliance wishes to say that it is not fighting segregation with segregation, it can call the thing that it is doing Transubstantiation or Willipuswallipus. Whatever they call it, that is what we both mean.</p>
</section>
<section id="negro-fraternities" class="level2">
<h2 class="anchored" data-anchor-id="negro-fraternities">Negro Fraternities</h2>
<p>Nothing better illustrates our current philosophy and practice in segregation, than the rise and development of Negro fraternities in colleges. When I was a student, fraternities were not allowed in Negro colleges and in the white colleges almost no fraternity ever accepted a Negro member. For a long time, Negro students went their way accepting this situation. When given opportunity, they protested against the Color Line in fraternities, and in a few cases, where the admission to fraternities depended upon scholarship, they succeeded in breaking the Color Line.</p>
<p>Nevertheless, it soon became manifest that there were certain things that the college fraternity could do for a student, which colored students were not getting in the large Northern universities. They lacked very often dormitory facilities; they had no place where they could entertain visiting friends; they had no social center; they had no opportunity for companionship and conference and mutual inspiration.</p>
<p>At Cornell, therefore, in 1906, a group of students formed the Alpha Phi Alpha Fraternity. There were many Negro students there, and in other places, at that time and since, who have condemned this movement as segregation while others excused it as voluntary segregation. It was segregation; and nevertheless, it was necessary; and it was voluntary only in the sense that either Negroes must have their own fraternity or forego fraternal advantages. It was, therefore, as a matter of fact just as compulsory as the “Jim-Crow” car.</p>
<p>This fraternity movement: has spread all over the United States. It has resulted in colored fraternities and sororities, whose membership runs into the thousands. If anyone has any doubt as to the meaning and inspiration of these fraternities, they should attend one of their national meetings and see the type of men and women that they are bringing together: the splendid enthusiasm, the inspiration and nationwide friendship. This is the kind of segregation that is forced upon us, and it is the kind of segregation in which we glory and which we are going to make the very finest type of institution that the United States has ever seen. And moreover, this is the singular and contradictory result: more Negroes have been taken into white fraternities since Negro fraternities started than ever before. The number thus admitted is still small, but it is not, as the timid argued, smaller; it is much larger.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-du_bois1934" class="csl-entry quarto-appendix-citeas" role="listitem">
Du Bois, W.E.B. 1934. <span>“Counsels of Despair.”</span> <em>The
Crisis</em> 41 (6): 182–84. <a href="https://www.dareyoufight.org/Volumes/41/06/counsels_of_despair.html">https://www.dareyoufight.org/Volumes/41/06/counsels_of_despair.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dareyoufight\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>