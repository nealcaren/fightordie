<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W.E.B. Du&nbsp;Bois">
<meta name="dcterms.date" content="1933-05-01">

<title>Marxism and The Negro Problem – Dare You Fight</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta name="citation_title" content="Marxism and The Negro Problem">
<meta name="citation_author" content="W.E.B. Du&nbsp;Bois">
<meta name="citation_publication_date" content="1933-05-01">
<meta name="citation_cover_date" content="1933-05-01">
<meta name="citation_year" content="1933">
<meta name="citation_online_date" content="1933-05-01">
<meta name="citation_fulltext_html_url" content="https://www.dareyoufight.org/Volumes/40/05/marxism_and_the_negro_problem.html">
<meta name="citation_issue" content="5">
<meta name="citation_volume" content="40">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="103">
<meta name="citation_lastpage" content="104, 118">
<meta name="citation_journal_title" content="The&nbsp;Crisis">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../Images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Dare You Fight</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../listing.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../credits.html"> 
<span class="menu-text">Credits</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../covers.html"> 
<span class="menu-text">Covers</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Marxism and The Negro Problem</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>W.E.B. Du&nbsp;Bois </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 1, 1933</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Karl Marx was a Jew born at Treves, Germany, in March, 1818. He came of an educated family and studied at the Universities of Bonn and Berlin, planning first to become a lawyer, and then to teach philosophy.</p>
<p>But his ideas were too radical for the government. He turned to journalism, and finally gave his life to economic reform, dying in London in 1883, after having lived in Germany, Belgium, France, and, for the last thirty-five years of his life, in England. He published in 1867, the first volume of his monumental work, “Capital.”</p>
<p>There are certain books in the world which every searcher for truth must know: the Bible, the Critique of Pure Reason, the Origin of Species, and Karl Marx’ “Capital.”</p>
<p>Yet until the Russian Revolution, Karl Marx was little known in America. He was treated condescendingly in the universities, and regarded even by the intelligent public as a radical agitator whose curious and inconvenient theories it was easy to refute. Today, at last, we all know better, and we see in Karl Marx a colossal genius of infinite sacrifice and monumental industry, and with a mind of extraordinary logical keenness and grasp. We may disagree with many of the great books of truth that I have named, and with “Capital,” but they can never be ignored.</p>
<p>At a recent dinner to Einstein, another great Jew, the story was told of a professor who was criticized as having “no sense of humor” because he tried to explain the Theory of Relativity in a few simple words. Something of the same criticism must be attached to anyone who attempts similarly to indicate the relation of Marxian philosophy and the American Negro problem. And yet, with all modesty, I am essaying the task knowing that it will be but tentative and subject to much criticism, both on my own part and that of other abler students.</p>
<p>The task which Karl Marx set himself was to study and interpret the organization of industry in the modern world. One of Marx’s earlier works, “The Communist Manifesto,” issued in 1848, on the eve of the series of democratic revolutions in Europe, laid down this fundamental proposition.</p>
<blockquote class="blockquote">
<p>That in every historical epoch the prevailing mode of economic production and exchange, and the social organization necessarily following from it, form the basis upon which is built up, and from which alone can be explained, the political and intellectual history of that epoch; that consequently the whole history of mankind. … has been a history of class struggles, contest between exploiting and exploited, ruling and oppressed classes; that the history of these class struggles forms a series of evolution in which, now-a-days, a stage has been reached where the exploited and oppressed class (the proletariat) cannot attain its emancipation from the sway of the exploiting and ruling class (the bourgeoisie) without, at the same time, and once and for all, emancipating society at large from all exploitation, oppression, class-distinction and class struggles.</p>
</blockquote>
<p>All will notice in this manifesto, phrases which have been used so much lately and so carelessly that they have almost lost their meaning. But behind them still is living and insistent truth. The class struggle of exploiter and exploited is a reality. The capitalist still today owns machines, materials, and wages with which to buy labor. The laborer even in America owns little more than his ability to work. A wage contract takes place between these two and the resultant manufactured commodity or service is the property of the capitalist.</p>
<p>Here Marx begins his scientific analysis based on a mastery of practically all economic theory before his time and on an extraordinary, thoroughgoing personal knowledge of industrial conditions over all Europe and many other parts of the world.</p>
<p>His final conclusions were never all properly published. He lived only to finish the first volume of his “Capital,” and the other two volumes were completed from his papers and notes by his friend Engels. The result is an unfinished work, extraordinarily difficult to read and understand and one which the master himself would have been first to criticize as not properly representing his mature and finished thought.</p>
<p>Nevertheless, that first volume, together with the fairly evident meaning of the others, lay down a logical line of thought. The gist of that philosophy is that the value of products regularly exchanged in the open market depends upon the labor necessary to produce them; that capital consists of machines, materials and wages paid for labor; that out of the finished product, when materials have been paid for and the wear and tear and machinery replaced, and wages paid, there remains a surplus value. This surplus value arises from labor and is the difference between what is actually paid laborers for their wages and the market value of the commodities which the laborers produce. It represents, therefore, exploitation of the laborer, and this exploitation, inherent in the capitalistic system of production, is the cause of poverty, of industrial crises, and eventually of social revolution.</p>
<p>This social revolution, whether we regard it as voluntary revolt or the inevitable working of a vast cosmic law of social evolution, will be the last manifestation of the class struggle, and will come by inevitable change induced by the very nature of the conditions under which present production is carried on, It will come by the action of the great majority of men who compose the wage-earning proletariat, and it will result in common ownership of all capital, the disappearance of capitalistic exploitation, and the division of the products and services of industry according to human needs, and not according to the will of the owners of capital.</p>
<p>It goes without saying that every step of this reasoning and every presentation of supporting facts have been bitterly assailed. The labor theory of value has been denied; the theory of surplus value refuted; and inevitability of revolution scoffed at; while industrial crises—at least until this present one—have been defended as unusual exceptions proving the rule of modern industrial efficiency.</p>
<p>But with the Russian experiment and the World Depression most thoughtful men today are beginning to admit:</p>
<p>That the continued recurrence of industrial crises and wars based largely on economic rivalry, with persistent poverty, unemployment, disease and crime, are forcing the world to contemplate the possibilities of fundamental change in our economic methods; and that means thorough-going change, whether it be violent, as in France or Russia, or peaceful, as seems just as possible, and just as true to the Marxian formula, if it is fundamental change; in any case, Revolution seems bound to come.</p>
<p>Perhaps nothing illustrates this better than recent actions in the United States: our re-examination of the whole concept of Property; our banking moratorium; the extraordinary new agriculture bill; the plans to attack unemployment, and similar measures. Labor rather than gambling is the sure foundation of value and whatever we call it—exploitation, theft or business acumen—there is something radically wrong with an industrial system that turns out simultaneously paupers and millionaires and sets a world starving because it has too much food.</p>
<p>What now has all this to do with the Negro problem? First of all, it is manifest that the mass of Negroes in the United States belong distinctly to the working proletariat. Of every thousand working Negroes less than a hundred and fifty belong to any class that could possibly be considered bourgeois. And even this more educated and prosperous class has but small connection with the exploiters of wage and labor. Nevertheless, this black proletariat is not a part of the white proletariat. Black and white work together in many cases, and influence each other’s rates of wages. They have similar complaints against capitalists, save that the grievances of the Negro worker are more fundamental and indefensible, ranging as they do, since-the day of Karl Marx, from chattel slavery, to the worst paid, sweated, mobbed and cheated labor in any civilized land.</p>
<p>And while Negro labor in America suffers because of the fundamental inequities of the whole capitalistic system, the lowest and most fatal degree of its suffering comes not from the capitalists but from fellow white laborers. It is white labor that deprives the Negro of his right to vote, denies him education, denies him affiliation with trade unions, expels him from decent houses and neighborhoods, and heaps upon him the public insults of open color discrimination.</p>
<p>It is no sufficient answer to say that capital encourages this oppression and uses it for its own ends. This may have excused the ignorant and superstitious Russian peasants in the past and some of the poor whites of the South today. But the bulk of American white labor is neither ignorant nor fanatical. It knows exactly what it is doing and it means to do it. William Green and Mathew Woll of the A. F. of L. have no excuse of illiteracy or religion to veil their deliberate intention to keep Negroes and Mexicans and other elements of common labor, in a lower proletariat as subservient to their interests as theirs are to the interests of capital.</p>
<p>This large development of a petty bourgeoisie within the American laboring class is a post-Marxian phenomenon and the result of the tremendous and world wide development of capitalism in the 20th Century. The market of capitalistic production has gained an effective world-wide organization. Industrial technique and mass production have brought possibilities in the production of goods and services which out-run even this wide market. A new class of technical engineers and managers has arisen forming a working class aristocracy between the older proletariat and the absentee owners of capital. The real owners of capital are small as well as large investors—workers who have deposits in savings banks and small holdings in stocks and bonds; families buying homes and purchasing commodities on installment; as well as the large and rich investors.</p>
<p>Of course, the individual laborer gets but an infinitesimal part of his income from such investments. On the other hand, such investments, in the aggregate, largely increase available capital for the exploiters, and they give investing laborers the capitalistic ideology. Between workers and owners of capital stand today the bankers and financiers who distribute capital and direct the engineers.</p>
<p>Thus the engineers and the saving better-paid workers, form a new petty bourgeois class, whose interests are bound up with those of the capitalists and antagonistic to those of common labor. On the other hand, common labor in America and white Europe far from being motivated by any vision of revolt against capitalism, has been blinded by the American vision of the possibility of layer after layer of the workers escaping into the wealthy class and becoming managers and employers of labor.</p>
<p>Thus in America we have seen a wild and ruthless scramble of labor groups over each other in order to climb to wealth on the backs of black labor and foreign immigrants. The Irish climbed on the Negroes. The Germans scrambled over the Negroes and emulated the Irish. The Scandinavians fought forward next to the Germans and the Italians and “Bohunks” are crowding up, leaving Negroes still at the bottom chained to helplessness, first by slavery, then by disfranchisement and always by the Color Bar.</p>
<p>The second influence on white labor both in America and Europe has been the fact that the extension of the world market by imperial expanding industry has established a world-wide new proletariat of colored workers, toiling under the worst conditions of 19th century capitalism, herded as slaves and serfs and furnishing by the lowest paid wage in modern history a mass of raw material for industry. With this largess the capitalists have consolidated their economic power, nullified universal suffrage and bribed the white workers by high wages, visions of wealth and the opportunity to drive “niggers.” Soldiers and sailors from the white workers are used to keep “darkies” in their “places” and white foremen and engineers have been established as irresponsible satraps in China and India, Africa and the West Indies, backed by the organized and centralized ownership of machines, raw materials, finished commodities and land monopoly over the whole world.</p>
<p>How now does the philosophy of Karl Marx apply today to colored labor? First of all colored labor has no common ground with white labor. No soviet of technocrats would do more than exploit colored labor in order to raise the status of whites. No revolt of a white proletariat could be started if its object was to make black workers their economic, political and social equals. It is for this reason that American socialism for fifty years has been dumb on the Negro problem, and the communists cannot even get a respectful hearing in America unless they begin by expelling Negroes.</p>
<p>On the other hand, within the Negro groups, in the United States, in West Africa, in South America and in the West Indies, petty bourgeois groups are being evolved. In South America and the West Indies such groups drain off skill and intelligence into the white group, and leave the black labor poor, ignorant and leaderless save for an occasional demagog.</p>
<p>In West Africa, a Negro bourgeoisie is developing with invested capital and employment of natives and is only kept from the conventional capitalistic development by the opposition and enmity of white capital, and the white managers and engineers who represent it locally and who display bitter prejudice and tyranny; and by white European labor which furnishes armies and navies and Empire “preference.” African black labor and black capital are therefore driven to seek alliance and common ground.</p>
<p>In the United States also a petty bourgeoisie is being developed, consisting of clergymen, teachers, farm owners, professional men and retail business men. The position of this class, however, is peculiar: they are not the chief or even large investors in Negro labor and therefore exploit it only here and there; and they bear the brunt of color prejudice because they express in word and work the aspirations of all black folk for emancipation. The revolt of any black proletariat could not, therefore, be logically directed against this class, nor could this class join either white capital, white engineers or white workers to strengthen the color bar.</p>
<p>Under these circumstances, what shall we say of the Marxian philosophy and of its relation to the American Negro? We can only say, as it seems to me, that the Marxian philosophy is a true diagnosis of the situation in Europe in the middle of the 19th Century despite some of its logical difficulties. But it must be modified in the United States of America and especially so far as the Negro group is concerned. The Negro is exploited to a degree that means poverty, crime, delinquency and indigence. And that exploitation comes not from a black capitalistic class but from the white capitalists and equally from the white proletariat. His only defense is such internal organization as will protect him from both parties, and such practical economic insight as will prevent inside the race group any large development of capitalistic exploitation.</p>
<p>Meantime, comes the Great Depression. It levels all in mighty catastrophe. The fantastic industrial structure of America is threatened with ruin. The trade unions of skilled labor are double-tongued and helpless. Unskilled and common white labor is too frightened at Negro competition to attempt united action. It only begs a dole. The reformist program of Socialism meets no response from the white proletariat because it offers no escape to wealth and no effective bar to black labor, and a mud-sill of black labor is essential to white labor’s standard of living. The shrill cry of a few communists is not even listened to, because and solely because it seeks to break down barriers between black and white. There is not at present the slightest indication that a Marxian revolution based on a united class-conscious proletariat is anywhere on the American far horizon. Rather race antagonism and labor group rivalry is still undisturbed by world catastrophe. In the hearts of black laborers alone, therefore, lie those ideals of democracy in politics and industry which may in time make the workers of the world effective dictators of civilization.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-du_bois1933" class="csl-entry quarto-appendix-citeas" role="listitem">
Du&nbsp;Bois, W.E.B. 1933. <span>“Marxism and The Negro Problem.”</span>
<em>The&nbsp;Crisis</em> 40 (5): 103–4, 118. <a href="https://www.dareyoufight.org/Volumes/40/05/marxism_and_the_negro_problem.html">https://www.dareyoufight.org/Volumes/40/05/marxism_and_the_negro_problem.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dareyoufight\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>