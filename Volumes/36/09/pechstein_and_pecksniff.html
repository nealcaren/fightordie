<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="W.E.B. Du&nbsp;Bois">
<meta name="dcterms.date" content="1929-09-01">

<title>Pechstein and Pecksniff – Dare You Fight</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta name="citation_title" content="Pechstein and Pecksniff">
<meta name="citation_author" content="W.E.B. Du&nbsp;Bois">
<meta name="citation_publication_date" content="1929-09-01">
<meta name="citation_cover_date" content="1929-09-01">
<meta name="citation_year" content="1929">
<meta name="citation_online_date" content="1929-09-01">
<meta name="citation_fulltext_html_url" content="https://www.dareyoufight.org/Volumes/36/09/pechstein_and_pecksniff.html">
<meta name="citation_issue" content="9">
<meta name="citation_volume" content="36">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="313">
<meta name="citation_lastpage" content="314">
<meta name="citation_journal_title" content="The&nbsp;Crisis">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../Images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Dare You Fight</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../listing.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../backround.html"> 
<span class="menu-text">Background</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../covers.html"> 
<span class="menu-text">Covers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../credits.html"> 
<span class="menu-text">Credits</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pechstein and Pecksniff</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>W.E.B. Du&nbsp;Bois </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 1, 1929</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Dr.&nbsp;R.L.A. Pechstein of the University of Cincinnati last February made a Report at the National Society of College Teachers meeting in Cleveland. His thesis was that the “Segregation of Negro and white children in separate schools accomplished far more for the black race than can be gained in mixed classes.”</p>
<p>He stated that among Negroes there were two opinions: That the Radicals ask for mixed schools, and the Conservatives want separate schools. His basis of fact was that Negro high schools had more Negro graduates than mixed high schools; that a study of 100 Negroes of eminence showed that 83 per cent attended separate elementary schools, and that about half attended mixed colleges; a study of 3,000 Negro pupils showed much mental deficiency and retardation, calling for special classes.</p>
<p>It is reported that he relied for his facts on the thesis of a colored school principal, Dr.&nbsp;Jennie Porter.</p>
<p>Propaganda further advocating this proposal has followed Pechstein’s paper. It is time that the matter be fairly faced and threshed out.</p>
<section id="school-democracy" class="level2">
<h2 class="anchored" data-anchor-id="school-democracy">School Democracy</h2>
<p>In the first place, it goes without saying that Pechstein ignores the background of his facts. He says nothing of the long battle for educational democracy which Negroes conservative and radical have fought in Boston, New York, Philadelphia and _ elsewhere. He knows perfectly well as an educator that the public school is not the best possible instrument for every single child. Very bright children, very dull children, timid children and over-grown, the children of the rich and cultured people, Catholic children, Jewish children,—can all make great and undoubted advance in certain lines if educated by themselves and segregated from the rest of the community.</p>
<p>Yet, the United States, Germany, France, and most civilized countries have urged the public school and democracy in education for all. And they have done this because of the fact that whatever may be lost in this group education, the human contact which comes through democratic education of all the youth of a great country, infinitely over balances it. They realize that if peace, good-will and industrial democracy are going to triumph in the world, they can only triumph by increase in the intelligence of individuals and the increase of direct knowledge and sympathetic human relationship among men. Any step backward from this: any building up of artificial barriers, Or over-emphasizing of natural barriers, is a blow in the face of civilization and human advance.</p>
<p>In the United States, we rightly fear the growth of a separate Catholic school system; we are apprehensive at the increased tendency of the rich and cultured to take their children out of the public schools and to make certain colleges segregated institutions for these children. We dislike the exclusive fraternities in colleges, and we ban them almost entirely in high schools.</p>
<p>Our feeling in all this matter is that the forces of disruption, of hatred, of enmity and of misunderstanding between groups and individuals are so tremendous today and have been so fatal in the past that there is almost no sacrifice that we ought not to be willing to make in order to put down increased separation among men and in order to multiply understanding, sympathy and human acquaintanceship.</p>
<p>This is the great foundation for the public school.</p>
<p>This program involves many difficulties. When the poor Irish came to Massachusetts in the middle of the 19th Century, there was bitter opposition to their presence in the public schools. They were ignorant, dirty, ragged and retarded. Italians and people from the Balkans of Southeast Europe later brought the same problems. Naturally, the Negroes, both in the past and present, have been a severe problem for the mixed public schools. By slavery, caste, law and custom, they have been ignorant and poverty-stricken and have lagged behind the average school age.</p>
</section>
<section id="the-negro-in-school" class="level2">
<h2 class="anchored" data-anchor-id="the-negro-in-school">The Negro in School</h2>
<p>And what of it? In a thousand different communities Negro pupils have proven their ability to profit by the public schools; they have made high records and graduated with honor. Their poverty is part of a universal problem; their retardation is due to wretched Southern school systems; their dullness comes from poor food and poor homes and there is absolutely no scientific proof that it is Negroid. Every one of these problems has a well known and adequately tested solution.</p>
<p>The recent migration of Negroes to the North has naturally intensified and re-opened these problems but it would be a despicable yielding to reaction and cowardice to give up democracy in the public schools because of the very disadvantages which lack of democracy and opportunity have fastened upon the Negro population of the South.</p>
<p>In the face of these problems many like Pechstein, narrow in reasoning and ignorant of all the facts are always rushing to find the easiest way out of the difficulty. With them work the Pecksniffs—the hypocrites who use any excuse to degrade and beat back the Negro. It is peculiarly Pecksniffian to raise the fact that most prominent Negroes have been educated in separate schools, as an argument for separate schools. Most Negroes had to be educated in separate schools or not be educated at all since for a hundred years more than 9/10 of them were offered “Jim-crow” schools or nothing. It is obvious that the well-known and magnificent Negro high schools of Baltimore and Washington send out a much larger proportion of well-trained Negro graduates than the Negro-baiting mixed high schools of a hundred different Northern cities. But Merciful God! is this an argument for segregation, or against discrimination, cruelty, cheating and hate on the part of white pupils, teachers and officials? If the success of the Dunbar High School is to be built on the lawless snobbery of Gary, what is American democracy headed for? The success of some separate Negro schools is a crushing indictment of hatred and prejudice and not a demand for further segregation.</p>
<p>If Negroes have done well in certain separate Negro schools, two speculations arise: how much more might Negroes have done if all their separate schools had been adequately equipped and taught; and further what might not the Negro pupil have done if without hurt or hindrance the whole educational opportunity of America had been open to him, without discrimination.</p>
</section>
<section id="the-jim-crow-school" class="level2">
<h2 class="anchored" data-anchor-id="the-jim-crow-school">The “Jim-Crow” School</h2>
<p>The well-equipped “Jim Crow” school is a rare exception. For the most part, such schools have been run on wretchedly inadequate resources; taught by ignorant teachers; housed in huts and dumps; and given just as little attention and supervision as the authorities dared give them. The discrimination against the separate Negro public schools in the United States is one of the most despicable and disgusting of the discriminations against this enslaved race and if Pechstein does not know this he is far more ignorant than we suspect.</p>
<p>If he does know it and still advocates separate schools, he may believe that funds can be had to make Negro schools decent and that segregation really settles the problem of Negro pupils. But how can a man of even elementary mentality argue this? Segregation if logical would double the cost of schools in the South and it distinctly increases it in Cincinnati. <em>Any proposal for separate Negro schools is in effect a demand for schools less well housed, less well supported, less well-equipped and less wellsupervised than the average public school.</em> How can segregation by color settle the problem of the retardation of stupid pupils? Not even the wildest Nordic claims that all Negroes are morons. If South Carolina spends $1.00 a year to educate.a colored child, when that child appears in the Cincinnati schools, he is bound to be backward. Mr.&nbsp;Pechstein proposes properly to give such children the special training which they need; but he does not stop here. He also proposes that into this special school shall go all colored children whether they are stupid or not! Now what is there that a purely Negro school can give backward Negro children which any school for the retarded cannot give them? And what can normal Negro children get in a Negro school that they cannot get in a mixed school? Everybody knows: everybody knows that a Catholic school differs from other schools by teaching catholicism in addition to the school curriculum; that a Young Ladies Finishing School teaches _refined snobbery and that a Negro school teaches race solidarity and race pride and (whether consciously or unconsciously) distrust of all white folks. Cf course the Negro school and the Catholic school and the schools for the rich will have teachers more sympathetic to their propaganda but this is the damnation of democracy and the shame of the teaching profession and not the goal and ideal of the public schools. Have we come to the day when only cripples can teach cripples and when the only hope of the Chinese is to protect them from white teachers?</p>
</section>
<section id="hypocrisy" class="level2">
<h2 class="anchored" data-anchor-id="hypocrisy">Hypocrisy</h2>
<p>Naturally little or nothing of this is in the Pechstein mind. Here, deliberately or gropingly, this mind goes Pecksnifian: Negroes can be best kept from too great and fast advance by segregating them into cheaper facilities and opportunities. They can be induced thus to commit hari-kari by subtle appeals to pride and poverty. After all black folk are no less stupid and avaricious than whites. Give them one extra fine public school such as the people of Cincinnati gave them, and the majority of Negroes will jump to receive it. It gives them their one opportunity to teach at home at good salaries; it gives them some chance to direct their own children’s education. The children themselves discover a school that welcomes and encourages them instead of sneering at them and kicking them out. But is this all? O, no! The Negro who comes through the Negro college and studies Negro history under black professors; the child who comes through the Negro school with Negro teachers, is going to grow up as a Negro and not as an American. He is going to hate and despise the civilization that enslaved him, and now insults him. He is going to believe that the world of white folk is armed against the world of black folk, and that one of these days they are going to fight it out to the bitter end. He is going to demand more and more the power to equip himself for this fight. Segregation breeds segregation. If Negroes must have separate schools, they should have separate school officials, a separate school budget, and a separate system of text books. They should push on to more separation and more self-government in every line of life. They will more and more resent the intervention of white folk in their life and suspect their every motive.</p>
</section>
<section id="the-logical-end-of-racial-segregation-is-caste-hate-and-war." class="level2">
<h2 class="anchored" data-anchor-id="the-logical-end-of-racial-segregation-is-caste-hate-and-war.">The logical end of racial segregation is Caste, Hate and War.</h2>
<p>Twelve million Americans, separate self-contained, increasingly powerful, increasingly race patriotic and suspicious will grow and expand in this land. And this is the thing that the University of Cincinnati, in the person of one of its scientific leaders, sets before the world of 1929, as the solution of the problem of the American citizens of Negro descent!</p>
<p><em>Citation:</em> Du&nbsp;Bois, W.E.B. 1929. “Pechstein and Pecksniff.” <em>The&nbsp;Crisis</em>. 36(9):313–314.</p>
<!-- Similar articles start here -->
<div class="clear-wrap">

</div>
<hr>
<section id="related-articles" class="level4">
<h4 class="anchored" data-anchor-id="related-articles">Related Articles:</h4>
<ul>
<li><a href="../../../Volumes/01/04/education.html">Education (1911)</a></li>
<li><a href="../../../Volumes/01/01/Segregation.html">Segregation (1910)</a></li>
<li><a href="../../../Volumes/39/09/employment.html">Employment (1932)</a></li>
<li><a href="../../../Volumes/36/05/negro_citizen.html">The Negro Citizen (1929)</a></li>
<li><a href="../../../Volumes/13/03/schools.html">Schools (1917)</a></li>
</ul>
<!-- Similar articles end here -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-du_bois1929" class="csl-entry quarto-appendix-citeas" role="listitem">
Du&nbsp;Bois, W.E.B. 1929. <span>“Pechstein and Pecksniff.”</span>
<em>The&nbsp;Crisis</em> 36 (9): 313–14. <a href="https://www.dareyoufight.org/Volumes/36/09/pechstein_and_pecksniff.html">https://www.dareyoufight.org/Volumes/36/09/pechstein_and_pecksniff.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dareyoufight\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>